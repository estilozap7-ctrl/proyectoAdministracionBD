<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentaci贸n Modelo de Datos - Better Homes Hotel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=JetBrains+Mono&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-primary: #f8fafc;
            --text-primary: #0f172a;
            --accent: #3b82f6;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .markdown-body {
            max-width: 900px;
            margin: 0 auto;
            padding: 4rem 2rem;
            background: white;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            min-height: 100vh;
        }

        h1 {
            @apply text-5xl font-extrabold mb-8 text-slate-900 border-b-4 border-blue-500 pb-4 tracking-tight;
        }

        h2 {
            @apply text-3xl font-bold mt-12 mb-6 text-slate-800 border-l-8 border-blue-400 pl-4;
        }

        h3 {
            @apply text-2xl font-semibold mt-8 mb-4 text-slate-700;
        }

        h4 {
            @apply text-xl font-medium mt-6 mb-2 text-slate-600 italic;
        }

        p {
            @apply mb-4 text-slate-600 text-lg;
        }

        ul {
            @apply list-disc pl-8 mb-6 space-y-2;
        }

        code {
            @apply font-mono bg-slate-100 px-1 rounded text-blue-600;
        }

        pre {
            @apply bg-slate-900 text-slate-100 p-6 rounded-xl overflow-x-auto my-6 shadow-inner text-sm;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        table {
            @apply w-full mb-8 border-collapse rounded-lg overflow-hidden shadow-sm;
        }

        th {
            @apply bg-slate-800 text-white p-4 text-left font-semibold uppercase text-xs tracking-wider;
        }

        td {
            @apply p-4 border-b border-slate-100 text-sm text-slate-600 hover:bg-slate-50 transition-colors;
        }

        hr {
            @apply my-12 opacity-20 border-slate-900;
        }

        .mermaid {
            @apply flex justify-center my-10 bg-white p-8 rounded-2xl border-2 border-slate-100 shadow-sm transition-all hover:shadow-md;
        }

        /* Estilo para impresi贸n */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .markdown-body {
                box-shadow: none;
                width: 100%;
                max-width: 100%;
                padding: 0;
            }

            .no-print {
                display: none;
            }

            pre {
                white-space: pre-wrap;
                word-wrap: break-word;
            }

            h2 {
                page-break-before: always;
            }
        }

        .btn-print {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            @apply bg-blue-600 text-white px-6 py-3 rounded-full font-bold shadow-2xl hover:bg-blue-700 transition-all active:scale-95 flex items-center gap-2;
            z-index: 100;
        }
    </style>
</head>

<body>

    <button onclick="window.print()" class="btn-print no-print">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 6 2 18 2 18 9"></polyline>
            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
            <rect x="6" y="14" width="12" height="8"></rect>
        </svg>
        Exportar a PDF
    </button>

    <div id="content" class="markdown-body">
        Cargando documentaci贸n...
    </div>

    <script>
        const markdownSource = `
# Documentaci贸n del Modelo de Datos - Better Homes Hotel

###  Desarrollado por:
*   **Luis Alberto Buelvas Cogollo** - Grupo 56647
*   **CAMILA ANDREA HERRERA GAMBOA** - Grupo 56648

**Curso:** ADMINISTRACION DE BASES DE DATOS  
**Docente:** SERGIO ALEXANDER MORA NOVOA  
**Programa:** Ingenier铆a de Sistemas  
**Instituci贸n:** Corporaci贸n Unificada Nacional de Educaci贸n Superior - CUN  
**A帽o:** 2026

---

Este documento describe la estructura de la base de datos \`hotel_db\`, detallando las entidades, sus atributos y las relaciones que permiten el funcionamiento del sistema de reservaciones.

## 1. Diagrama Entidad-Relaci贸n (ERD)

A continuaci贸n se presenta la representaci贸n conceptual de las entidades y c贸mo interact煤an entre s铆.

\`\`\`mermaid
erDiagram
    HUESPED ||--o{ RESERVACION : realiza
    HABITACION ||--o{ RESERVACION : contiene

    HUESPED {
        int id_huesped PK
        string nombre
        string apellido
        string email UK
        string telefono
        string documento UK
        string nacionalidad
        datetime creado_en
        datetime actualizado_en
    }

    HABITACION {
        int id_habitacion PK
        string numero UK
        enum tipo
        int capacidad
        decimal precio_noche
        int piso
        boolean disponible
        text descripcion
        datetime creado_en
        datetime actualizado_en
    }

    RESERVACION {
        int id_reservacion PK
        int id_huesped FK
        int id_habitacion FK
        date fecha_entrada
        date fecha_salida
        enum estado
        decimal precio_total
        text notas
        datetime creado_en
        datetime actualizado_en
    }
\`\`\`

---

## 2. Requerimientos del Sistema de Base de Datos

Para que el modelo de datos sea efectivo, debe cumplir con los siguientes requerimientos basados en las reglas de negocio del hotel.

### 2.1 Requerimientos Funcionales (RF)
Estos definen las acciones que la base de datos debe permitir y procesar.

*   **RF-01: Gesti贸n de Hu茅spedes:** La base de datos debe permitir el registro, actualizaci贸n y consulta de informaci贸n de clientes, asegurando que no existan correos o documentos duplicados.
*   **RF-02: Control de Inventario de Habitaciones:** Debe almacenar las caracter铆sticas de cada habitaci贸n (n煤mero, tipo, precio) y permitir el cambio din谩mico de su estado de disponibilidad.
*   **RF-03: Procesamiento de Reservaciones:** El sistema debe permitir vincular a un hu茅sped con una habitaci贸n espec铆fica en un rango de fechas determinado.
*   **RF-04: C谩lculo de Estancia:** La base de datos debe permitir el almacenamiento del precio total de la reserva, calculado en base al precio de la habitaci贸n y la duraci贸n de la estad铆a.
*   **RF-05: Clasificaci贸n de Habitaciones:** Soporte para diferentes categor铆as (Individual, Doble, Suite, Penthouse) con reglas de capacidad espec铆ficas.
*   **RF-06: Trazabilidad (Auditor铆a):** Cada registro en las tablas principales debe contar con su fecha de creaci贸n y 煤ltima actualizaci贸n autom谩tica.

### 2.2 Requerimientos No Funcionales (RNF)
Estos definen las cualidades de operaci贸n y seguridad del sistema de datos.

*   **RNF-01: Integridad Referencial:** Uso estricto de llaves for谩neas para impedir que se creen reservaciones sin hu茅spedes o habitaciones v谩lidas.
*   **RNF-02: Disponibilidad y Rendimiento:** La base de datos debe estar optimizada mediante 铆ndices (espec铆ficamente en \`email\`, \`documento\` y \`numero\`) para garantizar tiempos de respuesta r谩pidos durante las b煤squedas.
*   **RNF-03: Escalabilidad:** El dise帽o relacional debe permitir incrementar el n煤mero de habitaciones y hu茅spedes sin degradar el rendimiento.
*   **RNF-04: Consistencia Persistente:** Uso del motor InnoDB para asegurar que las transacciones sean ACID (Atomicidad, Consistencia, Aislamiento y Durabilidad).
*   **RNF-05: Seguridad de Datos:** Restricci贸n de acceso mediante usuarios espec铆ficos y contrase帽as cifradas en el archivo de configuraci贸n del servidor.

---

## 3. Modelo Relacional

El modelo relacional describe la implementaci贸n f铆sica de las tablas y sus restricciones de integridad.

### Tabla: \`huespedes\`
Almacena la informaci贸n de contacto e identificaci贸n de los clientes.

| Campo | Tipo | Restricciones | Descripci贸n |
| :--- | :--- | :--- | :--- |
| \`id_huesped\` | INT | PK, AI | Identificador 煤nico del hu茅sped. |
| \`nombre\` | VARCHAR(100) | NOT NULL | Nombre(s) del hu茅sped. |
| \`apellido\` | VARCHAR(100) | NOT NULL | Apellido(s) del hu茅sped. |
| \`email\` | VARCHAR(150) | UNIQUE, NOT NULL | Correo electr贸nico (validado). |
| \`telefono\` | VARCHAR(20) | NULL | N煤mero de contacto. |
| \`documento\` | VARCHAR(50) | UNIQUE, NULL | DNI, Pasaporte o ID oficial. |
| \`nacionalidad\` | VARCHAR(80) | NULL | Pa铆s de origen. |
| \`creado_en\` | DATETIME | NOT NULL | Fecha de registro en el sistema. |
| \`actualizado_en\` | DATETIME | NOT NULL | Fecha de 煤ltima modificaci贸n. |

### Tabla: \`habitaciones\`
Define las caracter铆sticas y disponibilidad de las unidades del hotel.

| Campo | Tipo | Restricciones | Descripci贸n |
| :--- | :--- | :--- | :--- |
| \`id_habitacion\` | INT | PK, AI | Identificador 煤nico de la habitaci贸n. |
| \`numero\` | VARCHAR(10) | UNIQUE, NOT NULL | N煤mero f铆sico (ej: '101'). |
| \`tipo\` | ENUM | NOT NULL | 'individual', 'doble', 'suite', 'penthouse'. |
| \`capacidad\` | INT | DEFAULT 2 | Capacidad m谩xima de personas. |
| \`precio_noche\` | DECIMAL(10,2)| NOT NULL | Costo por una noche de estancia. |
| \`piso\` | INT | NULL | Nivel en el que se encuentra. |
| \`disponible\` | BOOLEAN | DEFAULT TRUE | Estado de disponibilidad actual. |
| \`descripcion\` | TEXT | NULL | Detalles adicionales (vistas, servicios). |

### Tabla: \`reservaciones\`
Act煤a como la tabla de hechos que conecta a los hu茅spedes con las habitaciones.

| Campo | Tipo | Restricciones | Descripci贸n |
| :--- | :--- | :--- | :--- |
| \`id_reservacion\` | INT | PK, AI | Folio de la reservaci贸n. |
| \`id_huesped\` | INT | FK | Relaci贸n con \`huespedes(id_huesped)\`. |
| \`id_habitacion\` | INT | FK | Relaci贸n con \`habitaciones(id_habitacion)\`. |
| \`fecha_entrada\` | DATE | NOT NULL | Fecha de inicio del hospedaje. |
| \`fecha_salida\` | DATE | NOT NULL | Fecha de fin del hospedaje. |
| \`estado\` | ENUM | DEFAULT 'activa' | 'activa', 'cancelada', 'completada'. |
| \`precio_total\` | DECIMAL(10,2)| NULL | Monto total calculado por la estancia. |
| \`notas\` | TEXT | NULL | Comentarios o peticiones especiales. |

---

## 3. Relaciones y Reglas de Negocio

1.  **Hu茅sped a Reservaci贸n (1:N):**
    - Un hu茅sped puede tener m煤ltiples reservaciones a lo largo del tiempo.
    - Una reservaci贸n pertenece obligatoriamente a un 煤nico hu茅sped.

2.  **Habitaci贸n a Reservaci贸n (1:N):**
    - Una habitaci贸n puede estar asociada a muchas reservaciones (en fechas distintas).
    - Una reservaci贸n espec铆fica se asigna a una sola habitaci贸n.

3.  **Integridad Referencial:**
    - No se puede eliminar un hu茅sped o una habitaci贸n que tenga reservaciones activas vinculadas, garantizando la trazabilidad hist贸rica de los datos.

---

## 4. Implementaci贸n SQL y Administraci贸n (Vistas)

Para garantizar la fluidez en la administraci贸n de los datos, se han implementado Vistas que simplifican las consultas complejas.

### 4.1 C贸digo SQL de Creaci贸n (DDL)

\`\`\`sql
-- Creaci贸n de la base de datos
CREATE DATABASE IF NOT EXISTS hotel_db;
USE hotel_db;

-- Tabla de Hu茅spedes
CREATE TABLE huespedes (
    id_huesped INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    apellido VARCHAR(100) NOT NULL,
    email VARCHAR(150) UNIQUE NOT NULL,
    telefono VARCHAR(20),
    documento VARCHAR(50) UNIQUE,
    nacionalidad VARCHAR(80),
    creado_en DATETIME DEFAULT CURRENT_TIMESTAMP,
    actualizado_en DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- Tabla de Habitaciones
CREATE TABLE habitaciones (
    id_habitacion INT AUTO_INCREMENT PRIMARY KEY,
    numero VARCHAR(10) UNIQUE NOT NULL,
    tipo ENUM('individual', 'doble', 'suite', 'penthouse') DEFAULT 'individual',
    capacidad INT DEFAULT 2,
    precio_noche DECIMAL(10, 2) NOT NULL,
    piso INT,
    disponible BOOLEAN DEFAULT TRUE,
    descripcion TEXT,
    creado_en DATETIME DEFAULT CURRENT_TIMESTAMP,
    actualizado_en DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- Tabla de Reservaciones
CREATE TABLE reservaciones (
    id_reservacion INT AUTO_INCREMENT PRIMARY KEY,
    id_huesped INT NOT NULL,
    id_habitacion INT NOT NULL,
    fecha_entrada DATE NOT NULL,
    fecha_salida DATE NOT NULL,
    estado ENUM('activa', 'cancelada', 'completada') DEFAULT 'activa',
    precio_total DECIMAL(10, 2),
    notas TEXT,
    creado_en DATETIME DEFAULT CURRENT_TIMESTAMP,
    actualizado_en DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (id_huesped) REFERENCES huespedes(id_huesped),
    FOREIGN KEY (id_habitacion) REFERENCES habitaciones(id_habitacion)
);
\`\`\`

### 4.2 Cat谩logo de Funcionalidad: 10 Vistas SQL Profesionales

Para demostrar la versatilidad del modelo de datos, se han implementado 10 vistas que cubren todas las 谩reas cr铆ticas de la gesti贸n hotelera.

#### 1. Gesti贸n Operativa: Ocupaci贸n Actual (\`view_ocupacion_actual\`)
Muestra qu茅 habitaciones est谩n ocupadas hoy y qui茅n es el hu茅sped responsable.
\`\`\`sql
CREATE VIEW view_ocupacion_actual AS
SELECT hab.numero, hab.tipo, CONCAT(h.nombre, ' ', h.apellido) AS huesped, r.fecha_salida AS salida_prevista
FROM habitaciones hab
JOIN reservaciones r ON hab.id_habitacion = r.id_habitacion
JOIN huespedes h ON r.id_huesped = h.id_huesped
WHERE CURDATE() BETWEEN r.fecha_entrada AND r.fecha_salida AND r.estado = 'activa';
\`\`\`

#### 2. Inventario: Habitaciones Disponibles (\`view_disponibilidad_real\`)
Lista de habitaciones listas para ser rentadas inmediatamente.
\`\`\`sql
CREATE VIEW view_disponibilidad_real AS
SELECT numero, tipo, precio_noche, piso
FROM habitaciones
WHERE disponible = TRUE;
\`\`\`

#### 3. Finanzas: Ingresos por Reservaci贸n (\`view_detalle_ingresos\`)
Calcula el ingreso bruto de cada reserva basado en los d铆as de estancia.
\`\`\`sql
CREATE VIEW view_detalle_ingresos AS
SELECT r.id_reservacion, hab.numero, DATEDIFF(r.fecha_salida, r.fecha_entrada) AS noches, r.precio_total
FROM reservaciones r
JOIN habitaciones hab ON r.id_habitacion = hab.id_habitacion
WHERE r.estado = 'completada' OR r.estado = 'activa';
\`\`\`

#### 4. Marketing: Clientes VIP (\`view_clientes_vip\`)
Identifica a los 10 clientes que han generado m谩s ingresos al hotel.
\`\`\`sql
CREATE VIEW view_clientes_vip AS
SELECT h.nombre, h.apellido, h.email, SUM(r.precio_total) AS gasto_total
FROM huespedes h
JOIN reservaciones r ON h.id_huesped = r.id_huesped
GROUP BY h.id_huesped
ORDER BY gasto_total DESC
LIMIT 10;
\`\`\`

#### 5. Recepci贸n: Pr贸ximas Llegadas (\`view_llegadas_hoy\`)
Lista de hu茅spedes que deben realizar Check-In en la fecha actual.
\`\`\`sql
CREATE VIEW view_llegadas_hoy AS
SELECT r.id_reservacion, CONCAT(h.nombre, ' ', h.apellido) AS huesped, hab.numero AS habitacion
FROM reservaciones r
JOIN huespedes h ON r.id_huesped = h.id_huesped
JOIN habitaciones hab ON r.id_habitacion = hab.id_habitacion
WHERE r.fecha_entrada = CURDATE();
\`\`\`

#### 6. Mantenimiento: Pr贸ximas Salidas (\`view_salidas_hoy\`)
Lista de habitaciones que se liberar谩n hoy y requerir谩n limpieza.
\`\`\`sql
CREATE VIEW view_salidas_hoy AS
SELECT hab.numero, hab.tipo, r.fecha_salida
FROM habitaciones hab
JOIN reservaciones r ON hab.id_habitacion = r.id_habitacion
WHERE r.fecha_salida = CURDATE() AND r.estado = 'activa';
\`\`\`

#### 7. An谩lisis: Popularidad de Tipos de Habitaci贸n (\`view_popularidad_habitaciones\`)
Muestra qu茅 tipos de habitaci贸n son los m谩s reservados.
\`\`\`sql
CREATE VIEW view_popularidad_habitaciones AS
SELECT hab.tipo, COUNT(r.id_reservacion) AS total_reservas
FROM habitaciones hab
LEFT JOIN reservaciones r ON hab.id_habitacion = r.id_habitacion
GROUP BY hab.tipo
ORDER BY total_reservas DESC;
\`\`\`

#### 8. Auditor铆a: Reservas Canceladas (\`view_analisis_cancelaciones\`)
Reporte de reservaciones que no se concretaron para an谩lisis de p茅rdida.
\`\`\`sql
CREATE VIEW view_analisis_cancelaciones AS
SELECT r.id_reservacion, h.nombre, h.apellido, r.precio_total AS monto_perdido, r.creado_en
FROM reservaciones r
JOIN huespedes h ON r.id_huesped = h.id_huesped
WHERE r.estado = 'cancelada';
\`\`\`

#### 9. Contabilidad: Ingresos Mensuales (\`view_ingresos_mensuales\`)
Resumen de ganancias agrupado por mes y a帽o.
\`\`\`sql
CREATE VIEW view_ingresos_mensuales AS
SELECT YEAR(fecha_entrada) AS anio, MONTH(fecha_entrada) AS mes, SUM(precio_total) AS total_ingresos
FROM reservaciones
WHERE estado != 'cancelada'
GROUP BY anio, mes;
\`\`\`

#### 10. Gesti贸n: Estancias de Larga Duraci贸n (\`view_estancias_largas\`)
Lista de clientes con estancias superiores a 7 d铆as (potenciales clientes para descuentos).
\`\`\`sql
CREATE VIEW view_estancias_largas AS
SELECT CONCAT(h.nombre, ' ', h.apellido) AS huesped, r.fecha_entrada, r.fecha_salida, DATEDIFF(r.fecha_salida, r.fecha_entrada) AS dias
FROM reservaciones r
JOIN huespedes h ON r.id_huesped = h.id_huesped
WHERE DATEDIFF(r.fecha_salida, r.fecha_entrada) > 7;
\`\`\`

---

## 5. Conclusi贸n: Impacto en la Fluidez
Este cat谩logo de 10 vistas demuestra que el modelo no solo almacena datos, sino que genera **Inteligencia de Negocio**. Cada vista permite que la aplicaci贸n "Better Homes Hotel" responda con fluidez a las necesidades de recepcionistas, administradores y due帽os por igual.
`;

        document.getElementById('content').innerHTML = marked.parse(markdownSource);

        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#3b82f6',
                primaryTextColor: '#fff',
                primaryBorderColor: '#1d4ed8',
                lineColor: '#64748b',
                secondaryColor: '#f1f5f9',
                tertiaryColor: '#fff'
            }
        });
    </script>
</body>

</html>